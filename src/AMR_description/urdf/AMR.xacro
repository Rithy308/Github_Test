<?xml version="1.0" ?>
<robot name="AMR" xmlns:xacro="http://www.ros.org/wiki/xacro">

<!-- <xacro:arg name="use_ros2_control" default="true"/>
<xacro:arg name="sim_mode" default="false"/>

<xacro:if value="$(arg use_ros2_control)">
     <xacro:include filename="ros2_control.xacro" />
</xacro:if>
<xacro:unless value="$(arg use_ros2_control)">
     <xacro:include filename="gazebo_control.xacro" />
</xacro:unless> -->

<xacro:include filename="materials.xacro" />
<xacro:include filename="AMR.trans" />
<xacro:include filename="AMR.gazebo" />
<xacro:include filename="lidar.xacro" />
<xacro:include filename="depth_camera.xacro" />
<xacro:include filename="gazebo_control.xacro" />


<link name="base_link">
  <inertial>
    <origin xyz="0.2106509958296546 0.0009478040467019658 0.46443602233124787" rpy="0 0 0"/>
    <mass value="139.59911105270382"/>
    <inertia ixx="36.561469" iyy="42.238412" izz="22.972196" ixy="-0.033952" iyz="-0.061252" ixz="-11.657284"/>
  </inertial>
  <visual>
    <origin xyz="0 0 0" rpy="0 0 0"/>
    <geometry>
      <mesh filename="file://$(find AMR_description)/meshes/base_link.stl" scale="0.001 0.001 0.001"/>
    </geometry>
    <material name="yellow"/>
  </visual>
  <collision>
    <origin xyz="0 0 0" rpy="0 0 0"/>
    <geometry>
      <mesh filename="file://$(find AMR_description)/meshes/base_link.stl" scale="0.001 0.001 0.001"/>
    </geometry>
  </collision>
</link>

<!-- <link name="Dept_Camera_1">
  <inertial>
    <origin xyz="-0.013050189161612491 0.004758004874773573 -0.007933466437632708" rpy="0 0 0"/>
    <mass value="0.35127199280616256"/>
    <inertia ixx="0.000227" iyy="3.2e-05" izz="0.000229" ixy="1e-06" iyz="-0.0" ixz="0.0"/>
  </inertial>
  <visual>
    <origin xyz="-0.472533 -0.000231 -0.274021" rpy="0 0 0"/>
    <geometry>
      <mesh filename="file://$(find AMR_description)/meshes/Dept_Camera_1.stl" scale="0.001 0.001 0.001"/>
    </geometry>
    <material name="silver"/>
  </visual>
  <collision>
    <origin xyz="-0.472533 -0.000231 -0.274021" rpy="0 0 0"/>
    <geometry>
      <mesh filename="file://$(find AMR_description)/meshes/Dept_Camera_1.stl" scale="0.001 0.001 0.001"/>
    </geometry>
  </collision>
</link> -->

<link name="Wheel_left_1">
  <inertial>
    <origin xyz="3.208501255930196e-07 0.009999699678738871 3.762253440176e-07" rpy="0 0 0"/>
    <mass value="8.439369015753751"/>
    <inertia ixx="0.027863" iyy="0.052933" izz="0.027863" ixy="-0.0" iyz="0.0" ixz="-0.0"/>
  </inertial>
  <visual>
    <origin xyz="-0.039604 -0.251713 -0.068547" rpy="0 0 0"/>
    <geometry>
      <mesh filename="file://$(find AMR_description)/meshes/Wheel_left_1.stl" scale="0.001 0.001 0.001"/>
    </geometry>
    <material name="black"/>
  </visual>
  <collision>
    <origin xyz="-0.039604 -0.251713 -0.068547" rpy="0 0 0"/>
    <geometry>
      <mesh filename="file://$(find AMR_description)/meshes/Wheel_left_1.stl" scale="0.001 0.001 0.001"/>
    </geometry>
  </collision>
</link>

<link name="Wheel_right_1">
  <inertial>
    <origin xyz="6.802726765231526e-08 -0.010000099433498 -2.724531159709054e-07" rpy="0 0 0"/>
    <mass value="8.439369015753751"/>
    <inertia ixx="0.027863" iyy="0.052933" izz="0.027863" ixy="-0.0" iyz="0.0" ixz="-0.0"/>
  </inertial>
  <visual>
    <origin xyz="-0.040487 0.250051 -0.06542" rpy="0 0 0"/>
    <geometry>
      <mesh filename="file://$(find AMR_description)/meshes/Wheel_right_1.stl" scale="0.001 0.001 0.001"/>
    </geometry>
    <material name="black"/>
  </visual>
  <collision>
    <origin xyz="-0.040487 0.250051 -0.06542" rpy="0 0 0"/>
    <geometry>
      <mesh filename="file://$(find AMR_description)/meshes/Wheel_right_1.stl" scale="0.001 0.001 0.001"/>
    </geometry>
  </collision>
</link>

<link name="caster_back_right_1">
  <inertial>
    <origin xyz="-0.0731508100390656 0.005098941219638997 -0.041940292288869016" rpy="0 0 0"/>
    <mass value="1.290296500139985"/>
    <inertia ixx="0.001055" iyy="0.001612" izz="0.000899" ixy="1e-06" iyz="2e-06" ixz="-0.000384"/>
  </inertial>
  <visual>
    <origin xyz="0.327467 0.269769 -0.070021" rpy="0 0 0"/>
    <geometry>
      <mesh filename="file://$(find AMR_description)/meshes/caster_back_right_1.stl" scale="0.001 0.001 0.001"/>
    </geometry>
    <material name="red"/>
  </visual>
  <collision>
    <origin xyz="0.327467 0.269769 -0.070021" rpy="0 0 0"/>
    <geometry>
      <mesh filename="file://$(find AMR_description)/meshes/caster_back_right_1.stl" scale="0.001 0.001 0.001"/>
    </geometry>
  </collision>
</link>

<link name="caster_back_left_1">
  <inertial>
    <origin xyz="-0.07340081003906546 -0.004901058780361567 -0.041940292288869085" rpy="0 0 0"/>
    <mass value="1.290296500139985"/>
    <inertia ixx="0.001055" iyy="0.001612" izz="0.000899" ixy="1e-06" iyz="2e-06" ixz="-0.000384"/>
  </inertial>
  <visual>
    <origin xyz="0.327467 -0.270231 -0.070021" rpy="0 0 0"/>
    <geometry>
      <mesh filename="file://$(find AMR_description)/meshes/caster_back_left_1.stl" scale="0.001 0.001 0.001"/>
    </geometry>
    <material name="red"/>
  </visual>
  <collision>
    <origin xyz="0.327467 -0.270231 -0.070021" rpy="0 0 0"/>
    <geometry>
      <mesh filename="file://$(find AMR_description)/meshes/caster_back_left_1.stl" scale="0.001 0.001 0.001"/>
    </geometry>
  </collision>
</link>

<link name="caster_front_right_1">
  <inertial>
    <origin xyz="-0.07281478995655866 9.894121963771596e-05 -0.0429492330515733" rpy="0 0 0"/>
    <mass value="1.290296500139985"/>
    <inertia ixx="0.001066" iyy="0.001612" izz="0.000889" ixy="1e-06" iyz="2e-06" ixz="-0.000382"/>
  </inertial>
  <visual>
    <origin xyz="-0.403418 0.254769 -0.072927" rpy="0 0 0"/>
    <geometry>
      <mesh filename="file://$(find AMR_description)/meshes/caster_front_right_1.stl" scale="0.001 0.001 0.001"/>
    </geometry>
    <material name="red"/>
  </visual>
  <collision>
    <origin xyz="-0.403418 0.254769 -0.072927" rpy="0 0 0"/>
    <geometry>
      <mesh filename="file://$(find AMR_description)/meshes/caster_front_right_1.stl" scale="0.001 0.001 0.001"/>
    </geometry>
  </collision>
</link>

<link name="caster_front_left_1">
  <inertial>
    <origin xyz="-0.07368010727646174 9.889780825661498e-05 -0.041446421809972864" rpy="0 0 0"/>
    <mass value="1.290296500139985"/>
    <inertia ixx="0.00105" iyy="0.001612" izz="0.000904" ixy="1e-06" iyz="2e-06" ixz="-0.000385"/>
  </inertial>
  <visual>
    <origin xyz="-0.407295 -0.258402 -0.067098" rpy="0 0 0"/>
    <geometry>
      <mesh filename="file://$(find AMR_description)/meshes/caster_front_left_1.stl" scale="0.001 0.001 0.001"/>
    </geometry>
    <material name="red"/>
  </visual>
  <collision>
    <origin xyz="-0.407295 -0.258402 -0.067098" rpy="0 0 0"/>
    <geometry>
      <mesh filename="file://$(find AMR_description)/meshes/caster_front_left_1.stl" scale="0.001 0.001 0.001"/>
    </geometry>
  </collision>
</link>

<link name="storage_plate_1">
  <inertial>
    <origin xyz="0.3794928019877311 0.0002252821675970706 0.1129238576901195" rpy="0 0 0"/>
    <mass value="289.37067599452223"/>
    <inertia ixx="22.384787" iyy="27.396534" izz="44.376667" ixy="-0.035401" iyz="-0.0007" ixz="0.02438"/>
  </inertial>
  <visual>
    <origin xyz="0.466977 0.001547 -0.198725" rpy="0 0 0"/>
    <geometry>
      <mesh filename="file://$(find AMR_description)/meshes/storage_plate_1.stl" scale="0.001 0.001 0.001"/>
    </geometry>
    <material name="red"/>
  </visual>
  <collision>
    <origin xyz="0.466977 0.001547 -0.198725" rpy="0 0 0"/>
    <geometry>
      <mesh filename="file://$(find AMR_description)/meshes/storage_plate_1.stl" scale="0.001 0.001 0.001"/>
    </geometry>
  </collision>
</link>

<!-- <link name="laser_frame">
  <inertial>
    <origin xyz="-0.009002814138466486 0.00024464862940166206 0.02142204736920328" rpy="0 0 0"/>
    <mass value="0.5466180808352172"/>
    <inertia ixx="0.000229" iyy="0.000455" izz="0.000533" ixy="-3e-06" iyz="-2e-06" ixz="-4.7e-05"/>
  </inertial>
  <visual>
    <origin xyz="-0.411353 -0.000231 -1.200021" rpy="0 0 0"/>
    <geometry>
      <mesh filename="file://$(find AMR_description)/meshes/LiDAR_1.stl" scale="0.001 0.001 0.001"/>
      <cylinder radius="0.05" length="0.04"/>
    </geometry>
    <material name="silver"/>
  </visual>
  <collision>
    <origin xyz="-0.411353 -0.000231 -1.200021" rpy="0 0 0"/>
    <geometry>
      <mesh filename="file://$(find AMR_description)/meshes/LiDAR_1.stl" scale="0.001 0.001 0.001"/>
      <cylinder radius="0.05" length="0.04"/>
    </geometry>
  </collision>
</link> -->

<!-- <link name="laser_frame">
  <visual>
    <geometry>
     <cylinder radius="0.05" length="0.04"/>
    </geometry>
     <material name="red"/>
 </visual>
 <collision>
    <geometry>
      <cylinder radius="0.05" length="0.04"/>
    </geometry>
  </collision> -->
    <!-- <xacro:inertial_cylinder mass="0.1" length="0.04" radius="0.05">
      <origin xyz="0 0 0" rpy="0 0 0"/>
    </xacro:inertial_cylinder> -->
 <!-- </link> -->

<!-- <link name="LiDAR_1">
  <inertial>
    <origin xyz="-0.009002814138466486 0.00024464862940166206 0.02142204736920328" rpy="0 0 0"/>
    <mass value="0.5466180808352172"/>
    <inertia ixx="0.000229" iyy="0.000455" izz="0.000533" ixy="-3e-06" iyz="-2e-06" ixz="-4.7e-05"/>
  </inertial>
  <visual>
    <origin xyz="-0.411353 -0.000231 -1.200021" rpy="0 0 0"/>
    <geometry>
      <mesh filename="file://$(find AMR_description)/meshes/LiDAR_1.stl" scale="0.001 0.001 0.001"/>
    </geometry>
    <material name="silver"/>
  </visual>
  <collision>
    <origin xyz="-0.411353 -0.000231 -1.200021" rpy="0 0 0"/>
    <geometry>
      <mesh filename="file://$(find AMR_description)/meshes/LiDAR_1.stl" scale="0.001 0.001 0.001"/>
    </geometry>
  </collision>
</link> -->


<!-- <joint name="Rigid 1" type="fixed">
  <origin xyz="0.472533 0.000231 0.274021" rpy="0 0 0"/>
  <parent link="base_link"/>
  <child link="Dept_Camera_1"/>
</joint> -->

<joint name="Revolute 2" type="continuous">
  <origin xyz="0.040487 0.251713 0.06542" rpy="0 0 0"/>
  <parent link="base_link"/>
  <child link="Wheel_left_1"/>
  <axis xyz="0.0 1.0 0.0"/>
</joint>

<joint name="Revolute 3" type="continuous">
  <origin xyz="0.040487 -0.251713 0.06542" rpy="0 0 0"/>
  <parent link="base_link"/>
  <child link="Wheel_right_1"/>
  <axis xyz="-0.0 1.0 -0.0"/>
</joint>

<joint name="Rigid 4" type="fixed">
  <origin xyz="-0.327467 -0.270231 0.059027" rpy="0 0 0"/>
  <parent link="base_link"/>
  <child link="caster_back_right_1"/>
</joint>

<joint name="Rigid 5" type="fixed">
  <origin xyz="-0.327467 0.270231 0.059027" rpy="0 0 0"/>
  <parent link="base_link"/>
  <child link="caster_back_left_1"/>
</joint>

<joint name="Rigid 6" type="fixed">
  <origin xyz="0.407295 -0.254769 0.058527" rpy="0 0 0"/>
  <parent link="base_link"/>
  <child link="caster_front_right_1"/>
</joint>

<joint name="Rigid 7" type="fixed">
  <origin xyz="0.407295 0.254769 0.058527" rpy="0 0 0"/>
  <parent link="base_link"/>
  <child link="caster_front_left_1"/>
</joint>

<joint name="Rigid 8" type="fixed">
  <origin xyz="-0.466977 -0.001547 0.198725" rpy="0 0 0"/>
  <parent link="base_link"/>
  <child link="storage_plate_1"/>
</joint>

<!-- <joint name="laser_joint" type="fixed">
  <origin xyz="0.411353 0.000231 1.220021" rpy="0 0 0"/>
  <parent link="base_link"/>
  <child link="laser_frame"/>
</joint> -->

<!-- <joint name="Rigid 9" type="fixed">
  <origin xyz="0.411353 0.000231 1.200021" rpy="0 0 0"/>
  <parent link="base_link"/>
  <child link="LiDAR_1"/>
</joint> -->

<!-- <gazebo>
    <plugin name="box_bot_joint_state" filename="libgazebo_ros_joint_state_publisher.so">
      <ros>
          <remapping>~/out:=joint_states</remapping>
      </ros>
      <update_rate>30</update_rate>
      <joint_name>Revolute 2</joint_name>
      <joint_name>Revolute 3</joint_name> -->
      <!-- <joint_name>caster_joint</joint_name>      -->
    <!-- </plugin>
  </gazebo> -->

<!-- <sensor name="laser" type="ray">
            <pose> 0 0 0 0 0 0 </pose>
            <visualize>true</visualize>
            <update_rate>10</update_rate>
            <ray>
                <scan>
                    <horizontal>
                        <samples>360</samples>
                        <min_angle>-3.14</min_angle>
                        <max_angle>3.14</max_angle>
                    </horizontal>
                </scan>
                <range>
                    <min>0.3</min>
                    <max>12</max>
                </range>
            </ray>
            <plugin name="laser_controller" filename="libgazebo_ros_ray_sensor.so">
                <ros>
                    <argument>~/out:=scan</argument>
                </ros>
                <output_type>sensor_msgs/LaserScan</output_type>
                <frame_name>laser_frame</frame_name>
            </plugin>
  </sensor> -->
    




</robot>